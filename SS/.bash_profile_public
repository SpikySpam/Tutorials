#!/bin/bash

history -c
clear
export DIV="--------------------------------------------------"

echo $DIV
echo üòé LOADING BASH PROFILE INTO MEMORY
echo $DIV

# SET PATHS
export TF_VAR_PATH_MAIN=$TF_VAR_PATH/SS
export TF_VAR_PATH_APP=$TF_VAR_PATH/SS.APP
export TF_VAR_PATH_CLI=$TF_VAR_PATH/SS/CLI
export PATH="$TF_VAR_PATH_CLI:$PATH"

# SET SECRETS
export TF_VAR_NPM_USER="admin@example.com"
export TF_VAR_NPM_PASSWORD="changeme"

# SET ALIASSES
alias cdss='cd $TF_VAR_PATH; clear'
alias k='kubectl'
alias t='terraform'
alias ti='t init'
alias ta='t apply'
alias taa='ta -auto-approve'
alias taar='terraform apply -refresh=false -auto-approve'
alias tp='t plan'
alias tpr='tp -refresh=false'
alias td='t destroy'
alias tda='td -auto-approve'
alias tdar='tda -refresh=false'
alias tv='t validate'
alias tr='t refresh'

export INITIALIZE="true"

# INITIALIZE
initialize () {

  if [ $INITIALIZE == "false" ]; then
    echo
    echo ‚úÖ "Press ENTER to CONTINUE"
    echo ‚ùå "Press CTRL+C to EXIT"
    echo $DIV
    if [ $TF_VAR_C_AUTOSTART == false ]; then
      read
    fi
  fi

}

# LOAD VERSIONS
load_versions () {
  source $TF_VAR_PATH_MAIN/version/app/version.sh
  source $TF_VAR_PATH_MAIN/version/docker/version.sh
  source $TF_VAR_PATH_MAIN/version/helm/version.sh
  source $TF_VAR_PATH_MAIN/version/terraform/version.sh
  source $TF_VAR_PATH_MAIN/version/cli/version.sh
  source $TF_VAR_PATH_MAIN/version/cluster/version.sh
}

# FINALIZE
finalize () {

  echo $DIV
  echo ‚úÖ "ALL DONE"
  echo $DIV

}

#‚ùóDon't include commands that need interaction before INITIALIZE is set to FALSE.
#‚ùóThis script will be called from ~/.bash_profile in various places and needs to exit.

load_versions
initialize

# if [ $INITIALIZE == "false" ]; then

# fi

finalize

export INITIALIZE="false"